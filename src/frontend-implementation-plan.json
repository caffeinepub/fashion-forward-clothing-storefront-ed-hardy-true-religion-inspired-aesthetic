{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Rebel Denim Storefront â€” Fix product image mapping and broken assets",
  "requirements": [
    {
      "id": "REQ-16",
      "summary": "Correct frontend product image key-to-asset mapping to prevent missing/duplicate/wrong product photos and ensure Shop + Product Details render consistent images for each backend-provided key.",
      "acceptanceCriteria": [
        "For every Product.images key returned by the backend, getProductImagePath(key) resolves to the correct /assets/generated/*.png path for that product (no incorrect cross-mapping like mapping a cap/belt/skirt to an unrelated asset).",
        "Eliminate unintended duplicate mappings where multiple different product image keys point to the same asset file (duplicates are allowed only for deliberate multi-angle images of the same product).",
        "Shop page grid images and Product Details gallery images render consistently using the corrected mapping without showing the wrong garment type for the product name."
      ],
      "file_operations": [
        {
          "path": "frontend/src/lib/imagePaths.ts",
          "operation": "modify",
          "description": "Audit IMAGE_MAP and update key->asset associations so each backend Product.images key maps to the intended static asset under /assets/generated, removing incorrect cross-mappings (e.g., skirt/cap/belt keys pointing to unrelated assets) and limiting duplicates to deliberate multi-angle usage. Export a shared fallback image constant and (optionally) a development-only warning/log when an unknown key is encountered to aid future audits."
        },
        {
          "path": "frontend/src/pages/ShopPage.tsx",
          "operation": "modify",
          "description": "Harden Shop product card image rendering: handle products with empty/missing images arrays by falling back to the shared fallback image; add an <img> error handler to swap to fallback if a mapped asset fails to load so the grid does not show broken image icons."
        },
        {
          "path": "frontend/src/pages/ProductDetailsPage.tsx",
          "operation": "modify",
          "description": "Ensure Product Details gallery renders consistently with Shop by relying on the corrected mapping and shared fallback; guard against empty images arrays and add <img> error handlers for both the main image and thumbnails to replace failed loads with the fallback while keeping the gallery length aligned to Product.images."
        }
      ]
    },
    {
      "id": "REQ-17",
      "summary": "Ensure all product image assets referenced by the frontend mapping exist under frontend/public/assets/generated and load successfully without broken images.",
      "acceptanceCriteria": [
        "All referenced files under /assets/generated/ return HTTP 200 in the deployed app and render in <img> tags on both Shop and Product Details pages.",
        "No product card on the Shop page renders a broken image icon; each product shows its intended primary image.",
        "Product Details pages show the correct number of images based on Product.images length and each thumbnail loads successfully."
      ],
      "file_operations": [
        {
          "path": "frontend/public/assets/generated/product-living-off-experience-04.dim_1200x1200.png",
          "operation": "create",
          "description": "Add the required generated static asset file so any mapping reference to frontend/public/assets/generated/product-living-off-experience-04.dim_1200x1200.png loads successfully."
        },
        {
          "path": "frontend/public/assets/generated/product-living-off-experience-05.dim_1200x1200.png",
          "operation": "create",
          "description": "Add the required generated static asset file so any mapping reference to frontend/public/assets/generated/product-living-off-experience-05.dim_1200x1200.png loads successfully."
        },
        {
          "path": "frontend/public/assets/generated/product-living-off-experience-06.dim_1200x1200.png",
          "operation": "create",
          "description": "Add the required generated static asset file so any mapping reference to frontend/public/assets/generated/product-living-off-experience-06.dim_1200x1200.png loads successfully."
        },
        {
          "path": "frontend/public/assets/generated/product-living-off-experience-07.dim_1200x1200.png",
          "operation": "create",
          "description": "Add the required generated static asset file so any mapping reference to frontend/public/assets/generated/product-living-off-experience-07.dim_1200x1200.png loads successfully."
        },
        {
          "path": "frontend/public/assets/generated/product-living-off-experience-08.dim_1200x1200.png",
          "operation": "create",
          "description": "Add the required generated static asset file so any mapping reference to frontend/public/assets/generated/product-living-off-experience-08.dim_1200x1200.png loads successfully."
        },
        {
          "path": "frontend/public/assets/generated/product-living-off-experience-09.dim_1200x1200.png",
          "operation": "create",
          "description": "Add the required generated static asset file so any mapping reference to frontend/public/assets/generated/product-living-off-experience-09.dim_1200x1200.png loads successfully."
        },
        {
          "path": "frontend/public/assets/generated/product-living-off-experience-10.dim_1200x1200.png",
          "operation": "create",
          "description": "Add the required generated static asset file so any mapping reference to frontend/public/assets/generated/product-living-off-experience-10.dim_1200x1200.png loads successfully."
        },
        {
          "path": "frontend/src/lib/imagePaths.ts",
          "operation": "modify",
          "description": "After adding missing assets, re-audit IMAGE_MAP to ensure every referenced /assets/generated/*.png path corresponds to a file present under frontend/public/assets/generated (including: frontend/public/assets/generated/product-new-design-01.dim_1200x1200.png through frontend/public/assets/generated/product-new-design-12.dim_1200x1200.png, and frontend/public/assets/generated/product-living-off-experience-01.dim_1200x1200.png through frontend/public/assets/generated/product-living-off-experience-10.dim_1200x1200.png)."
        }
      ]
    }
  ]
}